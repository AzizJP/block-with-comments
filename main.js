(()=>{"use strict";var e=function(e,t,n,r){var o=e%10;return 1===o?t:o>=2&&o<=4?n:r};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===t(n)?n:String(n)}var a=r((function t(n,r,i,a){var c=this,l=a.reatingSelector,m=a.incrementId,u=a.decrementId,s=a.counterSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,"_timePassedSince",(function(t){return c._initialDate=new Date(t),c._dateNow=new Date,c._dateDifference=Math.abs(c._dateNow.getTime()-c._initialDate.getTime()),c._diffDays=Math.ceil(c._dateDifference/864e5),c._yearsPassed=Math.floor(c._diffDays/360),c._monthsPassed=Math.floor(c._diffDays%360/30),c._daysPassed=c._diffDays%360%30,c._years=e(c._yearsPassed,"год","года","лет"),c._months=e(c._monthsPassed,"месяц","месяца","месяцев"),c._days=e(c._daysPassed,"день","дня","дней"),0===c._yearsPassed&&0===c._monthsPassed?"".concat(c._daysPassed," ").concat(c._days," назад"):0===c._yearsPassed?"".concat(c._monthsPassed," ").concat(c._months," ").concat(c._daysPassed," ").concat(c._days," назад"):"".concat(c._yearsPassed," ").concat(c._years," ").concat(c._monthsPassed," ").concat(c._months," ").concat(c._daysPassed," ").concat(c._days," назад")})),o(this,"renderPostInfo",(function(e){var t=e.createdId,n=e.updatedId,r=e.viewedId;c._dateCreatedElement=document.getElementById("".concat(t)),c._dateUpdatedElement=document.getElementById("".concat(n)),c._viewedElement=document.getElementById("".concat(r)),c._buttons=document.querySelector(".".concat(c._reatingSelector)),c._countElement=c._buttons.querySelector(".".concat(c._counterSelector)),c._dateCreatedElement.textContent=c._timePassedSince(c._postInfo.dateCreated),c._dateUpdatedElement.textContent=c._timePassedSince(c._postInfo.dateUpdated),c._viewedElement.textContent="".concat(c._postInfo.viewed," раз"),c._setEventListeners()})),o(this,"_handleRatingIncrement",(function(){c._ratingElements.count++,c._countElement.textContent=c._ratingElements.count})),o(this,"_handleRatingDecrement",(function(){c._ratingElements.count--,c._countElement.textContent=c._ratingElements.count})),o(this,"_addPrompt",(function(e){if(!(document.body.clientWidth<1024)){var t=e.target,n=t.getBoundingClientRect(),r=t.dataset.prompt;if(r){c._ratingElements.promptElement=document.createElement("div"),c._ratingElements.promptElement.className=c._promptSelector,c._ratingElements.promptElement.innerHTML=r,c._buttons.append(c._ratingElements.promptElement);var o=n.left+t.offsetWidth+20,i=n.top-(c._ratingElements.promptElement.offsetHeight-t.offsetHeight)/2;i<0&&(i=n.top),c._ratingElements.promptElement.style.left="".concat(o,"px"),c._ratingElements.promptElement.style.top="".concat(i,"px")}}})),o(this,"_deletePrompt",(function(){c._ratingElements.promptElement&&(c._ratingElements.promptElement.remove(),c._ratingElements.promptElement=null)})),o(this,"_setEventListeners",(function(){c._incrementButtonElement=c._buttons.querySelector("#".concat(c._incrementId)),c._decrementButtonElement=c._buttons.querySelector("#".concat(c._decrementId)),c._incrementButtonElement.onclick=c._handleRatingIncrement,c._decrementButtonElement.onclick=c._handleRatingDecrement,c._buttons.onmouseover=function(e){return c._addPrompt(e)},c._buttons.onmouseout=c._deletePrompt})),this._postInfo=n,this._ratingElements=r,this._promptSelector=i,this._reatingSelector=l,this._incrementId=m,this._decrementId=u,this._counterSelector=s}));function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function m(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===c(t)?t:String(t)}var d=m((function e(t,n){var r=this,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"addComment",(function(e){r._container.prepend(r._renderer(e))})),u(this,"renderComments",(function(e){e.forEach((function(e){r.addComment(e)}))})),this._renderer=o,this._sectionSelector=n,this._container=document.querySelector(this._sectionSelector)})),_=function(e){return"".concat(e.slice(3,5),".").concat(e.slice(0,2),".").concat(e.slice(6))};function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function y(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function b(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===f(t)?t:String(t)}var h=y((function e(t,n){var r=this,o=t.userName,i=t.text,a=t.date,c=t.isLiked,l=n.templateId,m=n.cloneSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),b(this,"_getCommentTemplate",(function(){return document.querySelector("#".concat(r._templateId)).content.querySelector(".".concat(r._cloneSelector)).cloneNode(!0)})),b(this,"generateComment",(function(e){var t=e.nameSelector,n=e.textSelector,o=e.dateSelector,i=e.trashButtonId,a=e.likeButtonId;r._commentElement=r._getCommentTemplate(),r._userNameElement=r._commentElement.querySelector(".".concat(t)),r._userTextElement=r._commentElement.querySelector(".".concat(n)),r._commentDateElement=r._commentElement.querySelector(".".concat(o)),r._trashButtonElement=r._commentElement.querySelector("#".concat(i)),r._likeButtonElement=r._commentElement.querySelector("#".concat(a));var c=new Date,l=r._date,m=c.getDate()===new Date(_(l)).getDate(),u=c.getDate()-new Date(_(l)).getDate()==1;console.log(c.getDate(),new Date(_(l)).getDate());var s=c-new Date(_(l))<0;return r._userNameElement.textContent=r._userName,r._userTextElement.textContent=r._text,s?r._commentDateElement.textContent="прыжок в будущее - в ".concat(r._date.slice(0,11)," ").concat(r._date.slice(11)):m?r._commentDateElement.textContent="сегодня, в ".concat(r._date.slice(11)):u?r._commentDateElement.textContent="вчера, в ".concat(r._date.slice(11)):r._date.slice(11)?r._commentDateElement.textContent="".concat(r._date.slice(0,11)," в ").concat(r._date.slice(11)):r._commentDateElement.textContent=r._date,r._setEventListeners(),r._commentElement})),b(this,"_handleLikeClick",(function(e){r._isLiked?(e.classList.remove("comment__button_liked"),e.classList.add("comment__button_like"),r._isLiked=!1):(e.classList.remove("comment__button_like"),e.classList.add("comment__button_liked"),r._isLiked=!0)})),b(this,"_handleTrashClick",(function(e){e.remove()})),b(this,"_setEventListeners",(function(){r._likeButtonElement.addEventListener("click",(function(){return r._handleLikeClick(r._likeButtonElement)})),r._trashButtonElement.addEventListener("click",(function(){return r._handleTrashClick(r._commentElement)}))})),this._userName=o,this._text=i,this._date=a,this._isLiked=c,this._templateId=l,this._cloneSelector=m})),E=[{userName:"Cuphead",text:"Ты пробовал выстрелить из пальца XD?",date:"14.03.2023, 12:25",isLiked:!1},{userName:"Dr.Tea",text:"Кинь баг-репорт производителю",date:"13.03.2023, 13:25",isLiked:!1},{userName:"Чайный Барон",text:"Решил проблему следующим образом: нужно не только достать пакетик из упаковки, еще необходимо вскрыть пакетик и вытащить саму завариваемую часть",date:"10.03.2023, 13:25",isLiked:!1}];function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,P(r.key),r)}}function w(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function I(e,t,n){return(t=P(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){var t=function(e,t){if("object"!==S(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===S(t)?t:String(t)}var x=w((function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),I(this,"renderForm",(function(e){var t=e.formSelector,n=e.formWrapperSelector,r=e.inputId,i=e.textareaId,a=e.dateInputId,c=e.submitButtonId,l=e.cancelButtonId;o._formWrapper=document.querySelector(".".concat(n)),o._form=o._formWrapper.querySelector(".".concat(t)),o._submitButton=o._formWrapper.querySelector("#".concat(c)),o._cancelButton=o._formWrapper.querySelector("#".concat(l)),o._formName=document.querySelector("#".concat(r)),o._formText=document.querySelector("#".concat(i)),o._formDate=document.querySelector("#".concat(a)),o._setEventListeners()})),I(this,"_openPopup",(function(){o._isOpen=!0,o._formWrapper.style.display="flex"})),I(this,"_closePopup",(function(){o._formName.value="",o._formText.value="",o._formDate.value="",o._isOpen=!1,o._formWrapper.style.display="none"})),I(this,"addComment",(function(){o._comment.userName=o._formName.value,o._comment.text=o._formText.value,o._comment.date=o._formDate.valueAsNumber?new Date(o._formDate.valueAsNumber-108e5).toLocaleString().slice(0,17):(new Date).toLocaleString().slice(0,17),o._comment.isLiked=!1,o._commentList.push(o._comment),o._closePopup()})),I(this,"_closeByEsc",(function(e){o._isOpen&&"Escape"===e.key&&o._closePopup()})),I(this,"_handleSubmit",(function(e){e.preventDefault(),o._handleAddComment()})),I(this,"_setEventListeners",(function(){o._form.addEventListener("submit",o._handleSubmit),document.addEventListener("keydown",o._closeByEsc),o._addCommentButton.addEventListener("click",o._openPopup),o._cancelButton.addEventListener("click",o._closePopup)})),this._commentList=t,this._isOpen=!1,this._comment={},this._isAdded=!1,this._handleAddComment=n,this._addCommentButton=document.querySelector(".".concat(r))}));function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j(r.key),r)}}function k(e,t,n){return t&&D(e.prototype,t),n&&D(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function L(e,t,n){return(t=j(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){var t=function(e,t){if("object"!==C(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===C(t)?t:String(t)}var B=k((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),L(this,"_showInputError",(function(e){var t=e.nextSibling.nextSibling;t.style.display="inline",t.textContent=e.validationMessage})),L(this,"_deleteInputError",(function(e){var t=e.nextSibling.nextSibling;t.style.display="none",t.textContent=""})),L(this,"_isValid",(function(e){return e.validity.valid})),L(this,"_handleInputEvent",(function(){t._deleteInputError(t._userName),t._userName.removeEventListener("input",t._handleInputEvent)})),L(this,"_handleTextareaEvent",(function(){t._deleteInputError(t._text),t._text.removeEventListener("input",t._handleTextareaEvent)})),L(this,"enableValidation",(function(e){var n=e.formSelector,r=e.inputId,o=e.textareaId;return t._formElement=document.querySelector(".".concat(n)),t._userName=t._formElement.querySelector("#".concat(r)),t._text=t._formElement.querySelector("#".concat(o)),t._isValid(t._userName)||t._showInputError(t._userName),t._isValid(t._text)||t._showInputError(t._text),t._setEventListeners(),t._isValid(t._userName)&&t._isValid(t._text)})),L(this,"_setEventListeners",(function(){t._userName.addEventListener("input",t._handleInputEvent),t._text.addEventListener("input",t._handleTextareaEvent)}))})),T={templateId:"comments",cloneSelector:"comment"},N={formSelector:"form",formWrapperSelector:"form__wrapper",inputId:"user-name",inputErrorId:"user-error",textareaId:"comment-text",textareaErrorId:"text-error",dateInputId:"comment-date",submitButtonId:"submit-button",cancelButtonId:"cancel-button"},q={nameSelector:"comment__user-name",textSelector:"comment__user-text",dateSelector:"comment__info-date",trashButtonId:"trash",likeButtonId:"like"};function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}new a({dateCreated:"12.12.2018",dateUpdated:"12.25.2020",viewed:12e3},{count:0,promptElement:null},"post__prompt",{reatingSelector:"post__rating",incrementId:"rating-increment",decrementId:"rating-decrement",counterSelector:"post__rating_counter"}).renderPostInfo({createdId:"date-created",updatedId:"date-updated",viewedId:"viewed"});var A=new d({renderer:function(e){return new h(e,T).generateComment(q)}},".comments"),W=E.sort((function(e,t){return new Date(_(e.date))-new Date(_(t.date))}));A.renderComments(W);var M=new x(E,(function(){return R()}),"add-comment__button");M.renderForm(N);var V=new B,R=function(){if(V.enableValidation(N)){M.addComment();var e=(t=E,function(e){if(Array.isArray(e))return O(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).slice(E.length-1);A.renderComments(e)}var t}})();
//# sourceMappingURL=main.js.map